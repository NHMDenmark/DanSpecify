# Specify Batch Edit — User Guide

This guide explains how to use the **Batch Edit** tool in **Specify**, aimed at collection managers, curators, and other nature science professionals. It assumes some familiarity with Specify, but minimal technical expertise.

---

## Table of Contents

1. [What is Batch Edit?](#1-what-is-batch-edit)  
2. [When and why to use Batch Edit](#2-when-and-why-to-use-batch-edit)  
3. [Permissions & prerequisites](#3-permissions--prerequisites)  
4. [Understanding relationships: dependent vs independent](#4-understanding-relationships-dependent-vs-independent)  
5. [Step-by-step workflow](#5-step-by-step-workflow)  
   - [Create / choose a query](#51-create--choose-a-query)  
   - [Launch Batch Edit](#52-launch-batch-edit)  
   - [Editing data](#53-editing-data)  
   - [Validate your edits](#54-validate-your-edits)  
   - [Review results](#55-review-results)  
   - [Commit your changes](#56-commit-your-changes)  
   - [Rollback (if enabled)](#57-rollback-if-enabled)  
6. [Best practices & tips](#6-best-practices--tips)  
7. [Common pitfalls & limitations](#7-common-pitfalls--limitations)  
8. [Troubleshooting](#8-troubleshooting)  
9. [Summary / checklist](#9-summary--checklist)  

---

## 1. What is Batch Edit?

Batch Edit is a tool in Specify that lets you **edit many records at once**, using a spreadsheet-like interface.

You can:

- Add or correct data for hundreds or thousands of records.
- Standardize field values (correct grammatical or spelling errors).
- Update fields to comply with Darwin Core standards.

Unlike regular data entry, Batch Edit is designed for *bulk operations*, especially for cleanup and data-quality improvements.

---

## 2. When and Why to Use Batch Edit

Common use cases include:

- Correcting many records after a data import  
- Standardizing repeated fields (collector, locality, etc.)  
- Filling missing values  
- Fixing consistent typos or formatting errors  
- Updating **independent relationships** (often not editable via Workbench)

---

## 3. Permissions & Prerequisites

- Requires appropriate user roles (Collection Admin and above).  
- Requires access to **Query Builder** and **Workbench** tools.
- The following permission levels can be granted to Specify users: (Later, they could be used to distinguish among user levels.)  


| Permission            | Description                                                                                     |
|-----------------------|-------------------------------------------------------------------------------------------------|
| **Create**            | Can create new records in Batch Edit.                                                           |
| **Update**            | Can modify existing records.                                                                    |
| **Delete**            | Can delete base records.                                                                        |
| **Commit**            | Can upload (commit) the changes back to the database.                                           |
| **Rollback**          | Can roll back a Batch Edit data set (experimental).                                             |
| **Validate**          | Can validate the pending changes before committing.                                             |
| **Transfer**          | Can transfer records between collections.                                                       |
| **Create Recordset**  | Can save the results of a Batch Edit as a new Record Set.                                       |
| **Delete Dependents** | Controls whether dependent records can be deleted in Batch Edit.<br>If granted, Batch Edit will delete dependents when you clear all visible fields.<br> If not granted, clearing visible fields leaves dependent records in place (fields become empty). If a required field is emptied, validation will fail.<br> Note: Even with this permission, a dependent will not be deleted if it has its own dependents. For example, deleting a Determination will not succeed if there is a linked Determiner record. |
| **Edit Multiple Tables** | Controls whether related tables (relationships) are editable in Batch Edit. <br> If not granted, all relationship columns in the grid appear read-only. |


---

## 4. Understanding Relationships: Dependent vs Independent

### Why this matters
- Dependent records need caution.  
- Independent relationships often require Batch Edit for modification.

### Dependent relationships
- The existence of a child record depends on the existence of a parent record.
- If the parent is deleted, the dependent (child) should also be deleted.
- If all fields of a dependent record are cleared, the record can be safely deleted.   
- **Example:** `Determination` is dependent on `Collection Object`.
    - A **Collection Object Determination** cannot exist without a **Collection Object**.
    - If you **delete a Collection Object**, the dependent **Determinations** will also be deleted.
    - The **Taxon** records linked to the Determination will remain, as they are **independent**.

When using the WorkBench, you can upload new dependent records and link them to existing records in the database (i.e. new Determinations, Preparations, etc.).


### Independent relationships
- The related records can exist on its own.  
- Unlinking does **not** delete the record.
- **Example:** `Agent` (Cataloger) is linked to `Collection Object`.
    - The Cataloger (an Agent) can exist independently of any Collection Object referencing it.
    - If you remove the Cataloger from a Collection Object, the Agent record is not deleted from the database.

You cannot update links to independent records using the WorkBench; instead, you must use the Batch Edit tool.


---

## 5. Step-by-Step Workflow

### 5.1 Create / Choose a Query

Run a query on the data in Specify that you wish to edit, and, most importantly, you must add a unique, non-editable identifier to your query.

1. Create or open a Query on the data you wish to edit.
2. Add all the fields you want to edit or view.
3. Include **unique identifiers** (GUIDs, catalog numbers).  
4. Save the query by clicking the **Save Query** button in the top right and naming your query.  

![query](https://github.com/user-attachments/assets/911a012d-8c27-45e3-8184-4bcdccf5cd37)

---

### 5.2 Launch Batch Edit

1. Run the query.  
2. Click **Batch Edit**.  
3. The query results will display in a spreadsheet format (where read-only fields are grayed out).
4. You can access your dataset later via the Batch Edit tool in the left-side menu.

https://github.com/user-attachments/assets/12f7bc7f-6050-46da-8633-3215f80168ae


---

### 5.3 Editing Data

- The Batch Edit interface using the **WorkBench grid editor**, offering functionalities such as copy, paste, sort, fill up, fill down, etc.
- The Batch Edit tool provides an immediate visual verification. Cells that have been successfully changed will turn yellow.
- To revert back to the original data during editing, click the **Revert** button at the top right of the screen.
-  Once you are satisfied with your changes, **Save** your work.

https://github.com/user-attachments/assets/673586a9-6066-4b6b-913d-fb961651884f

---

### 5.4 Validate Your Edits

- Click the **Validate** button in the top-right area of the Workspace screen.  
- Fix any highlighted errors.  
- Re-validate until no errors remain.
- Once you are satisfied with your changes, **Save** your work.

---

### 5.5 Review Results

- Click the **Results** button (next to Validate) to see the total number of records that will be updated in each affected table.  
- If these numbers do not match your expectations, review your edits before committing changes.

It may be helpful to load and edit a small subset of records first, then create queries on the modified records to analyze the impact on related fields and tables. Once satisfied, proceed to apply the changes to all records.

After verifying that there are no validation errors, click the Commit button.

---

### 5.6 Commit Your Changes

- After verifying that there are no validation errors, click the **Commit** button. 
- Optionally save affected records as a **Record Set**.
- If you choose not to save initially, you can always return to the **Results** button and click **Create Record Set** later.


https://github.com/user-attachments/assets/944eadb9-e376-49ea-b3c8-c9c45a1311f4


---

### 5.7 Rollback (If Enabled)

- Roll Back in Batch Edit is highly experimental.
- Works mainly for simple fields; you cannot Roll Back relationships.
- **Enable relationships** (global): If enabled, **Roll Back is disabled**.
- Once you Roll Back a data set, it can no longer be edited—rerun the query if you want to try again.

---

## 6. Best Practices & Tips

- Always **backup** before major edits.  
- Start with small test batches.  
- Include GUIDs/IDs in queries.  
- Keep batch edits focused (one type of change at a time).  
- Save commits as Record Sets.  
- Coordinate with teammates to avoid conflicts.

---

## 7. Common Pitfalls & Limitations

- Concurrent edits by other users can cause commit failures.  
- Some fields cannot be edited (system or read-only).  
- Dependent records may be deleted if emptied.  
- Rollback may be limited or unavailable.  
- Large datasets may slow performance.

---

## 8. Troubleshooting

| Problem | Cause | Solution |
|--------|-------|----------|
| Validation errors | Invalid data | Correct and re-validate |
| Some rows not updated | Another user changed them | Re-run query and repeat |
| Rollback unavailable | Not enabled | Check preferences |
| Wrong relationships updated | Missing identifiers | Include GUIDs/IDs |
| Slow performance | Too many rows | Split into smaller batches |

---

## 9. Summary / Checklist

1. Build & save a query with identifiers.  
2. **Backup database**.  
3. Load query → Batch Edit.  
4. Make edits.  
5. **Validate**.  
6. Review **Results**.  
7. **Commit**.  
8. Save **Record Set**.  
9. Use **Rollback** carefully.

---
